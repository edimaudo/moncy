<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Moncy - Intelligent Capital Access Platform</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
            background: linear-gradient(135deg, #1e3a5f 0%, #2c5aa0 100%);
            color: #333;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .logo {
            font-size: 32px;
            font-weight: 700;
            color: #1e3a5f;
            margin-bottom: 8px;
        }

        .tagline {
            color: #666;
            font-size: 16px;
        }

        .nav-tabs {
            display: flex;
            gap: 10px;
            margin: 20px 0;
        }

        .tab-button {
            padding: 12px 24px;
            border: none;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .tab-button.active {
            background: #4a90e2;
            box-shadow: 0 4px 12px rgba(74, 144, 226, 0.3);
        }

        .tab-button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .tab-content {
            display: none;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .tab-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #1e3a5f;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #4a90e2;
        }

        .btn-primary {
            background: linear-gradient(135deg, #4a90e2, #357abd);
            color: white;
            padding: 14px 28px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(74, 144, 226, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(74, 144, 226, 0.4);
        }

        .match-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #4a90e2;
            transition: transform 0.3s ease;
        }

        .match-card:hover {
            transform: translateY(-4px);
        }

        .match-score {
            display: inline-block;
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e1e5e9;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4a90e2, #27ae60);
            transition: width 0.5s ease;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .metric-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .metric-value {
            font-size: 32px;
            font-weight: 700;
            color: #1e3a5f;
            margin-bottom: 8px;
        }

        .metric-label {
            color: #666;
            font-size: 14px;
        }

        .risk-indicator {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .risk-low { background: #d4edda; color: #155724; }
        .risk-medium { background: #fff3cd; color: #856404; }
        .risk-high { background: #f8d7da; color: #721c24; }

        .applicant-profile {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .profile-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e1e5e9;
        }

        .ai-insight {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-left: 4px solid #4a90e2;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .loading-spinner {
            border: 3px solid #e1e5e9;
            border-top: 3px solid #4a90e2;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-right: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .hidden { display: none; }

        .dashboard-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .status-container {
            display: flex;
            align-items: center;
            margin-top: 15px;
            font-weight: 600;
            color: #4a90e2;
        }
        
        .status-tracker {
            flex-grow: 1;
            height: 12px;
            background: #e1e5e9;
            border-radius: 6px;
            margin: 0 10px;
            overflow: hidden;
        }
        .status-fill {
            height: 100%;
            width: 0%; /* Start at 0% */
            background: #4a90e2;
            border-radius: 6px;
            transition: width 1s ease;
        }

        .icon-svg {
            width: 24px;
            height: 24px;
            margin-right: 10px;
            fill: #4a90e2;
        }

        .document-list {
            margin-top: 15px;
        }

        .document-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #e1e5e9;
        }
        .document-item:last-child {
            border-bottom: none;
        }

        /* Mobile-responsive styles */
        @media (max-width: 768px) {
            .nav-tabs {
                flex-direction: column;
            }
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">Moncy</div>
            <div class="tagline">Intelligent Capital Access Platform</div>
        </div>

        <div class="nav-tabs">
            <button class="tab-button active" onclick="showTab('borrower')">Borrower Application</button>
            <button class="tab-button" onclick="showTab('matching')">Intelligent Matching</button>
            <button class="tab-button" onclick="showTab('dashboard')">Dashboard</button>
            <!-- Lender Dashboard button is removed from the UI for a customer-facing experience -->
        </div>

        <!-- Borrower Application Tab -->
        <div id="borrower" class="tab-content active">
            <h2 style="color: #1e3a5f; margin-bottom: 20px;">Complete Your Business Profile</h2>
            <form id="borrowerForm" onsubmit="submitApplication(event)">
                <div class="form-group">
                    <label>Business Name</label>
                    <input type="text" id="businessName" required placeholder="Enter your business name">
                </div>
                
                <div class="form-group">
                    <label>Industry</label>
                    <select id="industry" required>
                        <option value="">Select your industry</option>
                        <option value="retail">Retail</option>
                        <option value="food">Food & Beverage</option>
                        <option value="services">Professional Services</option>
                        <option value="technology">Technology</option>
                        <option value="manufacturing">Manufacturing</option>
                        <option value="construction">Construction</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Monthly Revenue</label>
                    <select id="revenue" required>
                        <option value="">Select revenue range</option>
                        <option value="0-5000">$0 - $5,000</option>
                        <option value="5000-15000">$5,000 - $15,000</option>
                        <option value="15000-50000">$15,000 - $50,000</option>
                        <option value="50000+">$50,000+</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Funding Amount Needed</label>
                    <select id="fundingAmount" required>
                        <option value="">Select amount range</option>
                        <option value="5000-25000">$5,000 - $25,000</option>
                        <option value="25000-100000">$25,000 - $100,000</option>
                        <option value="100000-500000">$100,000 - $500,000</option>
                        <option value="500000+">$500,000+</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Business Stage</label>
                    <select id="businessStage" required>
                        <option value="">Select business stage</option>
                        <option value="startup">Startup (0-1 years)</option>
                        <option value="early">Early Stage (1-3 years)</option>
                        <option value="growth">Growth Stage (3-5 years)</option>
                        <option value="established">Established (5+ years)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Credit Score Range</label>
                    <select id="creditScore" required>
                        <option value="">Select credit range</option>
                        <option value="poor">Below 580</option>
                        <option value="fair">580-669</option>
                        <option value="good">670-739</option>
                        <option value="excellent">740+</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Purpose of Funding</label>
                    <textarea id="fundingPurpose" rows="3" placeholder="Describe how you plan to use the funding" required></textarea>
                </div>

                <button type="submit" class="btn-primary">Submit Application</button>
            </form>
        </div>

        <!-- Intelligent Matching Tab -->
        <div id="matching" class="tab-content">
            <h2 style="color: #1e3a5f; margin-bottom: 20px;">Your Personalized Funding Matches</h2>
            <div id="matchingResults">
                <p style="color: #666; text-align: center; padding: 40px;">Complete your application to see personalized funding opportunities</p>
            </div>
        </div>

        <!-- New Borrower Dashboard Tab -->
        <div id="dashboard" class="tab-content">
            <h2 style="color: #1e3a5f; margin-bottom: 20px;">Borrower Dashboard</h2>

            <!-- Welcome/Onboarding Message -->
            <div id="dashboard-welcome-card" class="dashboard-card">
                <h4 style="color: #1e3a5f; margin-bottom: 10px;">Welcome to your Dashboard!</h4>
                <p style="font-size: 14px; color: #666;">This is your central hub for tracking your application, communicating with lenders, and accessing key insights. Your journey to funding starts here.</p>
                <!-- Interactive tutorial button was removed as requested -->
            </div>

            <!-- Application Status Card -->
            <div id="dashboard-status-card" class="dashboard-card hidden">
                <h4 style="color: #1e3a5f; margin-bottom: 10px;">Application Status for <span id="dashboard-business-name"></span></h4>
                <div class="status-container">
                    <span>Application Received</span>
                    <div class="status-tracker">
                        <div id="status-progress-bar" class="status-fill"></div>
                    </div>
                    <span id="status-text">Processing...</span>
                </div>
            </div>

            <!-- Dashboard Content Grid -->
            <div id="dashboard-content-grid" class="dashboard-grid hidden">
                <!-- My Loan Overview Card -->
                <div class="dashboard-card" id="loan-overview-card">
                    <h4 style="color: #1e3a5f; margin-bottom: 15px;">My Loan Overview</h4>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                        <div>
                            <div style="font-size: 12px; color: #666;">Loan Amount</div>
                            <div id="loan-amount" style="font-size: 24px; font-weight: 700; color: #1e3a5f;">--</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: #666;">Remaining Balance</div>
                            <div id="remaining-balance" style="font-size: 24px; font-weight: 700; color: #ff5722;">--</div>
                        </div>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: flex-end;">
                        <div>
                            <div style="font-size: 12px; color: #666;">Next Payment Due</div>
                            <div id="next-payment-date" style="font-size: 18px; font-weight: 600; color: #27ae60;">--</div>
                        </div>
                    </div>
                </div>

                <!-- AI Insights Card -->
                <div class="dashboard-card">
                    <h4 style="color: #1e3a5f; margin-bottom: 15px;">Your AI-Powered Insights</h4>
                    <ul id="ai-insights-list" style="font-size: 14px; color: #666; list-style-type: disc; padding-left: 20px;">
                        <li><strong>Real-time Cash Flow Analysis:</strong> Our system is connected to your bank accounts to dynamically assess your repayment capability.</li>
                        <li><strong>Predictive Modeling:</strong> Based on your business data and market trends, we forecast a strong likelihood of continued growth.</li>
                        <li><strong>Document Verification:</strong> AI has parsed and verified your tax returns and business license in real-time.</li>
                        <li><strong>NLP Analysis:</strong> Your funding purpose essay highlighted "innovation" and "community impact" which are favorable keywords for our network of lenders.</li>
                    </ul>
                </div>

                <!-- Secure Inbox Card -->
                <div class="dashboard-card">
                    <h4 style="color: #1e3a5f; margin-bottom: 15px;">Secure Inbox</h4>
                    <div id="inbox-messages" style="font-size: 14px; color: #666;">
                        <p style="margin-bottom: 10px;"><strong>Lender: Opportunity Fund</strong><br/>Your loan application has moved to the underwriting stage. Please provide any additional required documents.</p>
                        <p style="margin-bottom: 10px;"><strong>Lender: Regional Business Grant Program</strong><br/>Your grant application is under review. The committee will contact you in the next 7 business days.</p>
                        <p><strong>System: Moncy Team</strong><br/>Welcome to Moncy! You can now track your application, share documents securely, and communicate with lenders here.</p>
                    </div>
                </div>

                <!-- My Documents Card -->
                <div class="dashboard-card">
                    <h4 style="color: #1e3a5f; margin-bottom: 15px;">My Documents</h4>
                    <div class="document-list">
                        <div class="document-item">
                            <span>Business Plan.pdf</span>
                            <span style="color: #27ae60;">Verified</span>
                        </div>
                        <div class="document-item">
                            <span>2022 Tax Returns.zip</span>
                            <span style="color: #27ae60;">Verified</span>
                        </div>
                        <div class="document-item">
                            <span>Bank Statements (Q3 2023).pdf</span>
                            <span style="color: #27ae60;">Verified</span>
                        </div>
                    </div>
                    <button class="btn-primary" style="margin-top: 15px; padding: 10px 20px; font-size: 14px;">Upload New Document</button>
                </div>

                <!-- Ecosystem Integration Card -->
                <div class="dashboard-card">
                    <h4 style="color: #1e3a5f; margin-bottom: 15px;">Ecosystem Support</h4>
                    <ul style="font-size: 14px; color: #666; list-style-type: disc; padding-left: 20px;">
                        <li><strong>Business Development:</strong> We have partnered with local business organizations to provide you with mentorship and growth strategies.</li>
                        <li><strong>Accounting Services:</strong> Connect with our network of accounting firms for streamlined bookkeeping and financial planning.</li>
                        <li><strong>Legal Services:</strong> Access legal support for business incorporation and contract review through our trusted partners.</li>
                        <li><strong>Financial Literacy:</strong> Access resources and workshops to help you manage your loan and grow your business sustainably.</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Lender Dashboard Tab (Hidden from navigation) -->
        <div id="lender" class="tab-content">
            <h2 style="color: #1e3a5f; margin-bottom: 20px;">Institutional Underwriting Dashboard</h2>
            
            <div class="dashboard-grid">
                <div class="metric-card">
                    <div class="metric-value">847</div>
                    <div class="metric-label">Total Applications</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">68%</div>
                    <div class="metric-label">Approval Rate</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">$12.4M</div>
                    <div class="metric-label">Capital Deployed</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">2.1%</div>
                    <div class="metric-label">Default Rate</div>
                </div>
            </div>

            <h3 style="color: #1e3a5f; margin: 30px 0 15px;">Recent Applications</h3>
            
            <div class="applicant-profile">
                <div class="profile-header">
                    <div>
                        <h4>TechStart Solutions</h4>
                        <p style="color: #666; margin: 5px 0;">Technology • $75,000 requested</p>
                    </div>
                    <span class="risk-indicator risk-low">Low Risk</span>
                </div>
                <div class="ai-insight">
                    <strong>AI Analysis:</strong> Strong cash flow patterns with 18-month operating history. Technology sector showing resilience. Recommend approval with standard terms.
                </div>
                <div style="display: flex; gap: 20px; font-size: 14px; color: #666;">
                    <span><strong>Monthly Revenue:</strong> $45,000</span>
                    <span><strong>Credit Score:</strong> 720</span>
                    <span><strong>Stage:</strong> Growth</span>
                </div>
            </div>

            <div class="applicant-profile">
                <div class="profile-header">
                    <div>
                        <h4>Maria's Catering</h4>
                        <p style="color: #666; margin: 5px 0;">Food & Beverage • $35,000 requested</p>
                    </div>
                    <span class="risk-indicator risk-medium">Medium Risk</span>
                </div>
                <div class="ai-insight">
                    <strong>AI Analysis:</strong> Seasonal revenue patterns typical for catering business. Strong local market presence. Consider seasonal adjustment terms or partner referral for business development.
                </div>
                <div style="display: flex; gap: 20px; font-size: 14px; color: #666;">
                    <span><strong>Monthly Revenue:</strong> $18,000</span>
                    <span><strong>Credit Score:</strong> 650</span>
                    <span><strong>Stage:</strong> Early</span>
                </div>
            </div>

            <div class="applicant-profile">
                <div class="profile-header">
                    <div>
                        <h4>Urban Retail Co</h4>
                        <p style="color: #666; margin: 5px 0;">Retail • $150,000 requested</p>
                    </div>
                    <span class="risk-indicator risk-low">Low Risk</span>
                </div>
                <div class="ai-insight">
                    <strong>AI Analysis:</strong> Established business with consistent growth trajectory. Strong inventory turnover and customer retention metrics. Excellent candidate for expansion funding.
                </div>
                <div style="display: flex; gap: 20px; font-size: 14px; color: #666;">
                    <span><strong>Monthly Revenue:</strong> $85,000</span>
                    <span><strong>Credit Score:</strong> 780</span>
                    <span><strong>Stage:</strong> Established</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        let applicationData = null;
        let matchedLoan = null;

        // Function to handle tab switching
        function showTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tab buttons
            document.querySelectorAll('.nav-tabs .tab-button').forEach(button => {
                button.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName).classList.add('active');

            // Add active class to the corresponding button
            const tabButton = document.querySelector(`[onclick="showTab('${tabName}')"]`);
            if (tabButton) {
                tabButton.classList.add('active');
            }
        }

        // Function to handle form submission and trigger AI matching
        function submitApplication(event) {
            event.preventDefault();
            
            // Collect form data
            applicationData = {
                businessName: document.getElementById('businessName').value,
                industry: document.getElementById('industry').value,
                revenue: document.getElementById('revenue').value,
                fundingAmount: document.getElementById('fundingAmount').value,
                businessStage: document.getElementById('businessStage').value,
                creditScore: document.getElementById('creditScore').value,
                fundingPurpose: document.getElementById('fundingPurpose').value
            };

            // Show loading state
            const submitButton = event.target.querySelector('button[type="submit"]');
            const originalText = submitButton.textContent;
            submitButton.innerHTML = '<span class="loading-spinner"></span>Processing Application...';
            submitButton.disabled = true;

            // Simulate AI processing
            setTimeout(() => {
                generateMatches();
                updateBorrowerDashboard();
                submitButton.textContent = originalText;
                submitButton.disabled = false;
                
                // Automatically switch to matching tab
                showTab('matching');
            }, 2000);
        }

        // Function to generate and display the matching results
        function generateMatches() {
            const matches = [
                {
                    name: "Community Development Financial Institution",
                    type: "CDFI Loan",
                    amount: "$25,000 - $150,000",
                    rate: "3.5% - 6.0%",
                    match: 94,
                    description: "Perfect match for your business stage and industry. Specializes in underserved communities with flexible underwriting."
                },
                {
                    name: "Small Business Administration 7(a)",
                    type: "SBA Loan",
                    amount: "$50,000 - $500,000",
                    rate: "8.5% - 11.5%",
                    match: 87,
                    description: "Government-backed loan with competitive terms. Your credit profile and revenue qualify for preferred rates."
                },
                {
                    name: "Opportunity Fund Microloan",
                    type: "Microloan",
                    amount: "$5,000 - $50,000",
                    rate: "7.0% - 12.0%",
                    match: 91,
                    description: "Fast approval process with business support services. Excellent for your funding amount and timeline."
                },
                {
                    name: "Regional Business Grant Program",
                    type: "Grant",
                    amount: "$10,000 - $25,000",
                    rate: "0% (No repayment)",
                    match: 78,
                    description: "Non-repayable funding for business expansion. Your industry and location make you eligible for this quarterly program."
                }
            ];

            let matchHTML = `
                <div style="background: linear-gradient(135deg, #f8f9fa, #e9ecef); padding: 20px; border-radius: 12px; margin-bottom: 25px;">
                    <h3 style="color: #1e3a5f; margin-bottom: 10px;">AI-Powered Analysis Complete</h3>
                    <p style="color: #666;">Based on your profile, we've identified ${matches.length} high-probability funding opportunities. Our algorithm analyzed 200+ lenders to find your best matches.</p>
                </div>
            `;

            matches.forEach(match => {
                matchHTML += `
                    <div class="match-card">
                        <div class="match-score">${match.match}% Match</div>
                        <h4 style="color: #1e3a5f; margin-bottom: 10px;">${match.name}</h4>
                        <div style="display: flex; gap: 15px; margin: 10px 0; font-size: 14px;">
                            <span><strong>Type:</strong> ${match.type}</span>
                            <span><strong>Amount:</strong> ${match.amount}</span>
                            <span><strong>Rate:</strong> ${match.rate}</span>
                        </div>
                        <p style="color: #666; margin: 15px 0;">${match.description}</p>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${match.match}%"></div>
                        </div>
                        <div style="margin-top: 15px;">
                            <button class="btn-primary" style="padding: 10px 20px; font-size: 14px;" onclick="acceptOffer('${match.name}', '${match.amount}', '${match.type}')">
                                Accept Offer
                            </button>
                        </div>
                    </div>
                `;
            });

            document.getElementById('matchingResults').innerHTML = matchHTML;
        }
        
        // Simulates accepting a loan offer and updating the dashboard
        function acceptOffer(lenderName, amount, type) {
            matchedLoan = { lender: lenderName, amount: amount, type: type };
            updateBorrowerDashboard();
            const modal = document.createElement('div');
            modal.style.cssText = 'position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);display:flex;align-items:center;justify-content:center;z-index:1000;';
            modal.innerHTML = `
                <div style="background:white;padding:30px;border-radius:12px;box-shadow:0 4px 20px rgba(0,0,0,0.2);text-align:center;max-width:400px;line-height:1.5;">
                    <h4 style="color:#1e3a5f;margin-bottom:15px;">Congratulations!</h4>
                    <p>You have accepted an offer from <strong>${lenderName}</strong>. Your loan of <strong>${amount}</strong> is now being processed.</p>
                    <button onclick="this.parentNode.parentNode.remove(); showTab('dashboard');" style="margin-top:20px;background:#4a90e2;color:white;padding:10px 20px;border:none;border-radius:8px;cursor:pointer;">Go to Dashboard</button>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Main function to update the borrower dashboard with dynamic content
        function updateBorrowerDashboard() {
            // Unhide the main dashboard content and hide the welcome card
            document.getElementById('dashboard-status-card').classList.remove('hidden');
            document.getElementById('dashboard-content-grid').classList.remove('hidden');
            document.getElementById('dashboard-welcome-card').classList.add('hidden');

            // Update business name in the status card
            if (applicationData && applicationData.businessName) {
                document.getElementById('dashboard-business-name').textContent = applicationData.businessName;
            }

            const statusProgressBar = document.getElementById('status-progress-bar');
            const statusText = document.getElementById('status-text');
            
            // Show initial application status
            statusProgressBar.style.width = '30%';
            statusText.textContent = 'Application Received & Processing';

            // Simulate the next stages of the application process
            setTimeout(() => {
                statusProgressBar.style.width = '60%';
                statusText.textContent = 'Matching with Lenders';
            }, 2000);

            setTimeout(() => {
                statusProgressBar.style.width = '85%';
                statusText.textContent = 'Offers Generated';
            }, 4000);
            
            // Check if a loan has been accepted
            if (matchedLoan) {
                setTimeout(() => {
                    statusProgressBar.style.width = '100%';
                    statusText.textContent = 'Funding Disbursed!';
                    
                    const loanAmount = matchedLoan.amount.includes('$') ? matchedLoan.amount : `$${matchedLoan.amount}`;
                    const nextPaymentDate = new Date();
                    nextPaymentDate.setDate(nextPaymentDate.getDate() + 30);
                    const formattedDate = nextPaymentDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });

                    // Update loan overview card with dynamic data
                    document.getElementById('loan-amount').textContent = loanAmount;
                    document.getElementById('remaining-balance').textContent = loanAmount;
                    document.getElementById('next-payment-date').textContent = formattedDate;

                    // Update AI Insights based on application data
                    const aiInsights = document.getElementById('ai-insights-list');
                    aiInsights.innerHTML = `
                        <li><strong>Cash Flow Analysis:</strong> Your business has shown consistent revenue of ${applicationData.revenue} which supports the loan amount.</li>
                        <li><strong>Predictive Modeling:</strong> Based on historical data, the AI forecasts a 95% repayment probability for this type of loan.</li>
                        <li><strong>NLP Analysis:</strong> Your funding purpose essay highlighted "innovation" and "community impact" which are favorable keywords for our network of lenders.</li>
                    `;
                }, 6000);
            }
        }
        
        // Simulates an interactive tutorial modal
        function showTutorial() {
             const modal = document.createElement('div');
            modal.style.cssText = 'position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);display:flex;align-items:center;justify-content:center;z-index:1000;';
            modal.innerHTML = `
                <div style="background:white;padding:30px;border-radius:12px;box-shadow:0 4px 20px rgba(0,0,0,0.2);text-align:center;max-width:500px;line-height:1.5;">
                    <h4 style="color:#1e3a5f;margin-bottom:15px;">Welcome to the Tutorial!</h4>
                    <p>This tutorial would guide you through filling out your application, understanding your matches, and managing your funds. Since this is a demo, we will close this now, but you would be able to learn every feature with a guided walkthrough.</p>
                    <button onclick="this.parentNode.parentNode.remove()" style="margin-top:20px;background:#4a90e2;color:white;padding:10px 20px;border:none;border-radius:8px;cursor:pointer;">Got it!</button>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // This function would be a placeholder for a real-time analytics update
        function updateMetrics() {
             const metricValues = [847, 68, 12.4, 2.1];
             const metricLabels = ['Total Applications', 'Approval Rate', 'Capital Deployed', 'Default Rate'];

            setInterval(() => {
                const metrics = document.querySelectorAll('.metric-value');
                metrics.forEach((metric, index) => {
                    if (Math.random() > 0.5) { // Update on a random chance
                        let newValue = metricValues[index];
                        if (index === 0) {
                            newValue += Math.floor(Math.random() * 3) + 1;
                        } else if (index === 1) {
                            newValue = Math.min(100, Math.max(0, newValue + (Math.random() > 0.5 ? 0.5 : -0.5))).toFixed(1);
                        } else if (index === 2) {
                            newValue = (newValue + (Math.random() > 0.5 ? 0.1 : -0.1)).toFixed(1);
                        } else if (index === 3) {
                            newValue = (newValue + (Math.random() > 0.5 ? 0.1 : -0.1)).toFixed(1);
                        }
                        
                        // Update the metric value
                        if (index === 2) {
                             metric.textContent = `$${newValue}M`;
                        } else if (index === 1 || index === 3) {
                             metric.textContent = `${newValue}%`;
                        } else {
                             metric.textContent = newValue;
                        }
                    }
                });
            }, 5000);
        }

        // Wait for the document to be fully loaded before running scripts
        document.addEventListener('DOMContentLoaded', function() {
            // Initial call to set up the dashboard metrics for the lender tab
            updateMetrics();
        });
    </script>
</body>
</html>
